"""\nBerxel SDK Python扩展编译配置\n适用于Ubuntu系统\n\n编译命令:\n    python setup.py build_ext --inplace\n\n作者: Zhuo\n日期: 2025-10-15\n"""\n\nfrom setuptools import setup, Extension\nimport numpy as np\nimport os\nimport sys\n\n# 检测操作系统\nis_linux = sys.platform.startswith('linux')\nis_windows = sys.platform.startswith('win')\n\n# 获取当前目录\ncurrent_dir = os.path.dirname(os.path.abspath(__file__))\n\n# 配置编译参数\nif is_linux:\n    # Ubuntu配置\n    include_dirs = [\n        np.get_include(),\n        os.path.join(current_dir, 'include'),           # 本地SDK头文件\n        '/usr/local/include/berxel',                   # 系统SDK头文件（如果已安装）\n    ]\n    library_dirs = [\n        os.path.join(current_dir, 'libs'),             # 本地SDK库\n        '/usr/local/lib',                               # 系统SDK库（如果已安装）\n    ]\n    libraries = ['BerxelHawk']\n    extra_compile_args = ['-std=c++11', '-O3']\n    extra_link_args = ['-Wl,-rpath,$ORIGIN/libs']      # 运行时库路径\n    \nelif is_windows:\n    # Windows配置（如果需要在Windows开发）\n    include_dirs = [\n        np.get_include(),\n        os.path.join(current_dir, 'include')\n    ]\n    library_dirs = [os.path.join(current_dir, 'libs')]\n    libraries = ['BerxelHawk']\n    extra_compile_args = ['/O2']\n    extra_link_args = []\n    \nelse:\n    raise RuntimeError(f\"不支持的操作系统: {sys.platform}\")\n\n# 定义扩展模块\nberxel_module = Extension(\n    'berxel_wrapper',\n    sources=[os.path.join(current_dir, 'src', 'berxel_wrapper.cpp')],\n    include_dirs=include_dirs,\n    library_dirs=library_dirs,\n    libraries=libraries,\n    extra_compile_args=extra_compile_args,\n    extra_link_args=extra_link_args if is_linux else []\n)\n\nsetup(\n    name=\"berxel_wrapper\",\n    version=\"1.0.0\",\n    description=\"Berxel P100R深度相机Python接口\",\n    author=\"Zhuo\",\n    ext_modules=[berxel_module],\n    install_requires=[\n        'numpy>=1.19.0',\n    ],\n    python_requires='>=3.8',\n)\n